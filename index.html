<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Criminopat√≠a ¬∑ Expediente Final</title>

<style>
body{
  margin:0;
  background:#0e0e12;
  color:#f2f2f2;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}
.wrap{ max-width:720px; margin:auto; padding:20px; }
.card{
  background:#17171c;
  border:1px solid #2b2b36;
  border-radius:18px;
  padding:18px;
  box-shadow:0 20px 40px rgba(0,0,0,.35);
}
h1{ font-size:22px; margin:0 0 6px; }
.timer{ font-weight:bold; color:#ffd36e; }
.q{
  margin-top:16px;
  padding:14px;
  background:#121217;
  border-radius:14px;
  border:1px dashed #3a3a46;
}
button{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:12px;
  border:1px solid #333343;
  background:#1f1f28;
  color:#f2f2f2;
  font-size:15px;
  cursor:pointer;
}
button:hover{ background:#2a2a36; }
button:disabled{ opacity:.5; cursor:not-allowed; }
.ok{ color:#7CFFB2; }
.bad{ color:#ff8b8b; }
.lock{ color:#ff5252; font-weight:bold; }
img{
  width:100%;
  border-radius:16px;
  margin-top:20px;
  display:none;
  border:1px solid #2b2b36;
}
.download{
  display:none;
  margin-top:10px;
  background:#2a7cff;
  text-align:center;
  padding:12px;
  border-radius:12px;
  border:1px solid #333343;
  color:#fff;
  text-decoration:none;
}
</style>
</head>

<body>
<div class="wrap">
<div class="card">

<h1>üóÇÔ∏è Expediente confidencial</h1>
<p>‚è≥ Tiempo restante: <span class="timer" id="timer"></span> s</p>

<div id="quiz"></div>
<p id="msg"></p>

<!-- DECISI√ìN -->
<div id="decision" style="display:none;">
  <div class="q">
    <h2>üïØÔ∏è Has llegado a un punto de elecci√≥n</h2>
    <button onclick="ganar()">üéÅ Aceptar recompensa</button>
    <button onclick="continuar()">üîç Seguir investigando</button>
  </div>
</div>

<img id="reward" src="regalo.png">
<a id="downloadBtn" class="download" download href="regalo.png">‚¨áÔ∏è Descargar evidencia</a>

</div>
</div>

<audio id="okSound" src="acierto.mp3"></audio>
<audio id="failSound" src="fallo.mp3"></audio>

<script>
/* CONFIG */
const TIEMPO = 15;
const MAX_FALLOS = 3;
const STORAGE_KEY = "criminopatia_bloqueado";

/* BLOQUE 1 (10) */
const BLOQUE1 = [
 {q:"¬øCu√°ntas chicas desaparecieron en el caso Alc√†sser?",o:["Tres","Dos","Cuatro"],c:"Tres"},
 {q:"¬øQu√© sigue siendo un misterio en el caso Marta del Castillo?",o:["El paradero del cuerpo","La autor√≠a","La fecha"],c:"El paradero del cuerpo"},
 {q:"¬øQui√©nes fueron condenados por el caso Asunta?",o:["Sus padres","Un profesor","Un desconocido"],c:"Sus padres"},
 {q:"El error judicial en Wanninkhof se debi√≥ a‚Ä¶",o:["Pruebas circunstanciales","Confesi√≥n","V√≠deo"],c:"Pruebas circunstanciales"},
 {q:"¬øD√≥nde apareci√≥ Diana Quer?",o:["En un pozo","En el mar","En un bosque"],c:"En un pozo"},
 {q:"Relaci√≥n del condenado en Urquijo",o:["Yerno","Empleado","Vecino"],c:"Yerno"},
 {q:"V√≠ctimas del caso Bret√≥n",o:["Sus hijos","Su pareja","Un familiar"],c:"Sus hijos"},
 {q:"¬øD√≥nde ocurri√≥ el crimen de Patraix?",o:["En un garaje","En una casa","En la calle"],c:"En un garaje"},
 {q:"Prueba clave Wanninkhof‚ÄìCarabantes",o:["ADN","Testimonio","Confesi√≥n"],c:"ADN"},
 {q:"Apodo de Gabriel Cruz",o:["El Pesca√≠to","El Principito","El Ni√±o"],c:"El Pesca√≠to"}
];

/* BLOQUE 2 (10) */
const BLOQUE2 = [
 {q:"¬øD√≥nde ocurri√≥ el crimen de los Galindos?",o:["En una finca","En un hotel","En un puerto"],c:"En una finca"},
 {q:"¬øEn qu√© pa√≠s desapareci√≥ Madeleine McCann?",o:["Portugal","Espa√±a","Italia"],c:"Portugal"},
 {q:"¬øQu√© s√≠mbolo se asocia al asesino de la baraja?",o:["Naipes","Una rosa","Una moneda"],c:"Naipes"},
 {q:"Puerto Hurraco fue una‚Ä¶",o:["Venganza familiar","Estafa","Accidente"],c:"Venganza familiar"},
 {q:"Condenada medi√°tica de la Guardia Urbana",o:["Rosa Peral","Dolores V√°zquez","Ana Julia"],c:"Rosa Peral"},
 {q:"Caso Nagore Laffage ocurri√≥ en‚Ä¶",o:["San Ferm√≠n","Nochevieja","Carnaval"],c:"San Ferm√≠n"},
 {q:"¬øA qui√©n asesinaron en Fago?",o:["Al alcalde","A un juez","A un periodista"],c:"Al alcalde"},
 {q:"Ciudad del crimen del rol",o:["Madrid","Valencia","Sevilla"],c:"Madrid"},
 {q:"Segunda v√≠ctima Wanninkhof",o:["Sonia Carabantes","Asunta","Marta"],c:"Sonia Carabantes"},
 {q:"Ocultaci√≥n en el caso Bret√≥n",o:["Quemar los cuerpos","Enterrarlos","Arrojarlos"],c:"Quemar los cuerpos"}
];

let preguntas = [...BLOQUE1];
let indice = 0;
let fallos = 0;
let tiempo = TIEMPO;
let intervalo;

/* BLOQUEO */
if(localStorage.getItem(STORAGE_KEY)){
 document.getElementById("quiz").innerHTML =
 "<p class='lock'>üö´ Caso cerrado permanentemente</p>";
 throw new Error("Bloqueado");
}

function mezclar(a){ return a.sort(()=>Math.random()-0.5); }

function iniciarTimer(){
 tiempo = TIEMPO;
 document.getElementById("timer").innerText = tiempo;
 clearInterval(intervalo);
 intervalo = setInterval(()=>{
   tiempo--;
   document.getElementById("timer").innerText = tiempo;
   if(tiempo<=0) terminar("‚è±Ô∏è Tiempo agotado");
 },1000);
}

function render(){
 iniciarTimer();
 const p = preguntas[indice];
 let html = `<div class="q"><h2>${p.q}</h2>`;
 mezclar([...p.o]).forEach(op=>{
   html += `<button onclick="responder('${op}','${p.c}')">${op}</button>`;
 });
 html += "</div>";
 document.getElementById("quiz").innerHTML = html;
}

function responder(sel,cor){
 clearInterval(intervalo);
 if(sel===cor){
   document.getElementById("okSound").play();
   document.getElementById("msg").innerHTML="<span class='ok'>‚úîÔ∏è Correcto</span>";
   indice++;

   if(indice===10 && preguntas.length===10){
     document.getElementById("quiz").innerHTML="";
     document.getElementById("decision").style.display="block";
     document.getElementById("timer").innerText="‚Äî";
     return;
   }

   if(indice>=preguntas.length){ ganar(); return; }
   setTimeout(render,600);
 }else{
   fallos++;
   document.getElementById("failSound").play();
   document.getElementById("msg").innerHTML=
     `<span class="bad">‚ùå Fallo ${fallos}/${MAX_FALLOS}</span>`;
   if(fallos>=MAX_FALLOS) terminar("Demasiados errores");
   else setTimeout(render,600);
 }
}

function continuar(){
 preguntas = [...BLOQUE1,...BLOQUE2];
 document.getElementById("decision").style.display="none";
 render();
}

function terminar(txt){
 clearInterval(intervalo);
 localStorage.setItem(STORAGE_KEY,"1");
 document.getElementById("quiz").innerHTML="";
 document.getElementById("decision").style.display="none";
 document.getElementById("msg").innerHTML=
 `<span class='lock'>üö´ ${txt}. El caso se archiva.</span>`;
}

function ganar(){
 clearInterval(intervalo);
 document.getElementById("quiz").innerHTML="";
 document.getElementById("decision").style.display="none";
 document.getElementById("reward").style.display="block";
 document.getElementById("downloadBtn").style.display="block";
 document.getElementById("msg").innerHTML=
 "<span class='ok'>üèÜ Investigaci√≥n completada</span>";
}

render();
</script>
</body>
</html>

